<?php
$servername = "localhost";
$username = "root";
$password = "";
$dbname = "ISPMS";

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                  CONNECTING WITH THE DATABASE
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


try {
    $conn = new PDO("mysql:host=$servername", $username, $password);
    // set the PDO error mode to exception
    $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $sql = "CREATE DATABASE ISPMS";
    // use exec() because no results are returned
    $conn->exec($sql);
    echo "Database created successfully<br>";
} catch (PDOException $e) {
    // echo $sql . "<br>" . $e->getMessage() . "<br>" ;
}

$conn = null;



///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                  Packages TABLE
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

try {
    $conn = new PDO("mysql:host=$servername;dbname=$dbname", $username, $password);
    // set the PDO error mode to exception
    $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

    // sql to create Packages table
    $sql = "CREATE TABLE Packages (
    pid INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    pname VARCHAR(30) NOT NULL,
    ptype VARCHAR(30) NOT NULL,
    pspeed VARCHAR(30) NOT NULL,
    fee VARCHAR(30) NOT NULL,
    reg_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP

    )";

    $conn->exec($sql);
    echo "Table Packages created successfully<br>";
} catch (PDOException $e) {
    // echo $sql . "<br>" . $e->getMessage();
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                  CUSTOMER TABLE
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/// Creating Centers Table in ISPMS
try {
    $conn = new PDO("mysql:host=$servername;dbname=$dbname", $username, $password);
    // set the PDO error mode to exception
    $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

    // sql to create Centers table
    $sql = "CREATE TABLE Customer (
    cid INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    cname VARCHAR(50),
    caddress VARCHAR(50),
    cnid VARCHAR(50),
    cemail VARCHAR(50),
    cphone VARCHAR(50),
    cpassword VARCHAR(50),
    reg_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    UNIQUE (cnid,cphone,cemail)

    )";

    $conn->exec($sql);
    echo "Table Customer created successfully<br>";
} catch (PDOException $e) {
    // echo $sql . "<br>" . $e->getMessage();
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                  UserPackages TABLE
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/// Creating Children Table in ISPMS
try {
    $conn = new PDO("mysql:host=$servername;dbname=$dbname", $username, $password);
    // set the PDO error mode to exception
    $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

    // sql to create UserPackages table
    $sql = "CREATE TABLE UserPackages (
    upid INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    cid INT(6) UNSIGNED,
    pname VARCHAR(50),
    cstatus VARCHAR(50),
    currentplan VARCHAR(50),
    requestedplan VARCHAR(50),
    ptype VARCHAR(50),
    pspeed INT(6) UNSIGNED ,
    fee INT(6) UNSIGNED ,
    cdate DATE NOT NULL,
    caddress VARCHAR(30) ,
    cemail VARCHAR(50),
    cphone VARCHAR(50),
    FOREIGN KEY (cid) REFERENCES Customer(cid)ON DELETE SET NULL,
    reg_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
    )";

    $conn->exec($sql);
    echo "Table UserPackages created successfully<br>";
} catch (PDOException $e) {
    // echo $sql . "<br>" . $e->getMessage();
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                  EMPLOYEE TABLE
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



/// Creating Employee table in ISPMS
try {
    $conn = new PDO("mysql:host=$servername;dbname=$dbname", $username, $password);
    // set the PDO error mode to exception
    $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

    // sql to create Employee table
    $sql = "CREATE TABLE Employee (
    eid INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    ename VARCHAR(50),
    eaddress VARCHAR(50),
    ephone VARCHAR(50),
    eemail varchar(55),
    designation VARCHAR(50),
    salary INT(50),
    cv BLOB,
    reg_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    UNIQUE(eemail,ephone)
  )";

    // use exec() because no results are returned
    $conn->exec($sql);
    echo "Table Employee created successfully<br>";
} catch (PDOException $e) {
    // echo $sql . "<br>" . $e->getMessage();
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                 Complains TABLE
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/// Creating Complains Table in ISPMS
try {
    $conn = new PDO("mysql:host=$servername;dbname=$dbname", $username, $password);
    // set the PDO error mode to exception
    $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

    // sql to create Complains table
    $sql = "CREATE TABLE Complains (
    complainid INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    cname VARCHAR(55),
    caddress VARCHAR(50),
    cnid VARCHAR(55),
    cemail INT(6) UNSIGNED,
    cphone VARCHAR(55),
    issuetype INT(5),
    ctime VARCHAR(55),
    descriptions VARCHAR(500),
    reg_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
    )";

    $conn->exec($sql);
    echo "Table Complains created successfully<br>";
} catch (PDOException $e) {
    // echo $sql . "<br>" . $e->getMessage();
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//                                                 Payment TABLE
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



try {
    $conn = new PDO("mysql:host=$servername;dbname=$dbname", $username, $password);
    // set the PDO error mode to exception
    $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

    // sql to create Payment table
    $sql = "CREATE TABLE Payment (
    paymentid INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    amount INT(6), -- Adjust the precision and scale as needed
    paymentdate DATE,
    paymenttime TIME,
    transactionid VARCHAR(50),
    paymentmethod VARCHAR(50),
    cid INT(6) UNSIGNED,
    FOREIGN KEY (cid) REFERENCES Customer(cid)
    )";

    $conn->exec($sql);
    echo "Table Payment created successfully<br>";
} catch (PDOException $e) {
    // Handle any potential exceptions here
    // echo "Error creating Payment table: " . $e->getMessage();
}


$conn = null;

?>